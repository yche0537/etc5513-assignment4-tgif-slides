---
title: "Xaringan Template"
subtitle: "An example"
author: "- Cui, Di", "GuanRu, Chen", "Yunzhi, Chen"
institute: "Master of Business Analytics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: css/style.css
    yolo: FALSE
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r libraries, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(datasets)
library(readr)
library(kableExtra)
library(bookdown)
library(gridExtra)
library(viridis)
library(plotly)

```



---

### Global meat production -- Di Cui

How did global meat production develop from 1961 to 2018?

```{r Q1, echo = FALSE, message = FALSE, warning = FALSE, fig.cap="Global meat production from 1961 to 2018", fig.width=10, fig.height=5.5, fig.align='center'}

global_production <-read.csv(here::here("Data/global-meat-production.csv"))
production <- read.csv(here::here("Data/meat-production-tonnes.csv"))

global_production <- global_production %>%
  rename("meat_production" = "Livestock.Primary...Meat..Total...1765...Production...5510...tonnes") %>%
  mutate(meat_production = round(meat_production/1000000, digits = 2)) %>%
  filter(Entity %in% c("Oceania", "Africa", "Central America", "South America", "Northern America", "Europe", "Asia")) 

df <- global_production %>%
  group_by(Entity) %>%
  mutate(meat_sum = sum(meat_production)) %>%
  ungroup() %>%
  arrange(meat_sum) 

df <- df %>%
  mutate(Entity = factor(Entity, unique(Entity))) %>%
  group_by(Year) %>%
  mutate(total = sum(meat_production))

ggplot(df, aes(x = Year, y = meat_production, color = Entity))+
  geom_line()+
  scale_fill_brewer(palette = "Set3")+
  scale_x_continuous(breaks = c(1961,1970,1980, 1990, 2000, 2010,2018))+
  scale_y_continuous(breaks = c(0, 10, 50, 100, 150))+
  ylab("livestock meat production (million tonnes)")+
  theme_bw()

```

---
class: left, top

### Meat production in Asia has increased around 15 times.

```{r table, echo = FALSE, message = FALSE, warning = FALSE}
increase <- df %>%
  filter(Year == 2018 | Year == 1961) %>%
  select(Entity, Year, meat_production) %>%
  pivot_wider(names_from = Year, values_from = meat_production) %>%
  rename("Year2018" = "2018", "Year1961" = "1961" ) %>%
  mutate(P1961 = round(Year1961*100/sum(Year1961), digits = 2)) %>%
  mutate(P2018 = round(Year2018*100/sum(Year2018), digits = 2)) %>%
  mutate(times = round((Year2018-Year1961)/Year1961, digits = 2)) 
increase %>%
  arrange(-P2018)%>%
  knitr::kable(caption = "Comparison between 1961 and 2018") %>%
  kable_styling()

```

---

How did the Top six countries of meat production develop from 1961 to 2018?

```{r country, echo = FALSE, message = FALSE, warning = FALSE, fig.cap="Top six countries' meat production from 1961 to 2018", fig.width=10, fig.height=6.5, fig.align='center'}
production <- production %>%
   rename("meat_production" = "Livestock.Primary...Meat..Total...1765...Production...5510...tonnes") %>%
  mutate(meat_production = round(meat_production/1000000, digits = 2)) 

df2 <- production %>%
  group_by(Entity) %>%
  mutate(meat_sum = sum(meat_production)) %>%
  ungroup() %>%
  arrange(-meat_sum) 

df2 <- df2 %>%
  filter(Code != "" &
        Code %in% c("CHN", "USA", "BRA", "DEU", "FRA", "ARG"))

ggplot(df2, aes(x = Year, y = meat_production, color = Entity))+
  geom_line()+
  scale_fill_brewer(palette = "Set3")+
  scale_x_continuous(breaks = c(1961,1970,1980, 1990, 2000, 2010,2018))+
  ylab("Top 6 countries of livestock meat production (million tonnes)")+
  theme_bw()

ggplotly()

```



---
class: left, top

The world's meat production has around quadrupled.

China has increased about 34 times.

```{r country-table, echo = FALSE, message = FALSE, warning = FALSE}
increase2 <- production %>%
  group_by(Entity) %>%
  filter(Code != "" &
        Code %in% c("CHN", "USA", "BRA", "DEU", "FRA", "ARG" ,"OWID_WRL"))%>%
  filter(Year == 2018 | Year == 1961) %>%
  select(Entity, Year, meat_production) %>%
  pivot_wider(names_from = Year, values_from = meat_production) %>%
  rename("Year2018" = "2018", "Year1961" = "1961" ) %>%
  mutate(P1961 = round(Year1961*100/71.36, digits = 2)) %>%
  mutate(P2018 = round(Year2018*100/342.42, digits = 2)) %>%
  mutate(times = round((Year2018-Year1961)/Year1961, digits = 2)) 
  

increase2 %>%
  arrange(-P2018)%>%
  knitr::kable(caption = "Comparison between 1961 and 2018") %>%
 kable_styling()


```





---
class: center, middle
# Meat production by livestock type
Presenter:GaunRu Chen.

---
class: left, top
# Research Questions

.content-box-neutral[ 
- What's the production distribution of different livestock types across the world?
- Which countries are main production country for different types of meat, such as: Beef and buffalo, pig and poultry?
]


---
class: middle, center

```{r load-data, echo = FALSE , message = FALSE, warning = FALSE}
GD <- read_csv(file = "Data/global-meat-production.csv")
MT <- read_csv(file = "Data/global-meat-production-by-livestock-type.csv")
```

```{r fig1, echo = FALSE , message = FALSE, warning = FALSE, fig.cap = "Global meat production by livestock type, 1961 to 2018"}
pt_world <- MT %>%
  select(-Code) %>% 
  rename("Sheep & Goat"= "Livestock Primary - Sheep and Goat Meat - 1807 - Production - 5510 - tonnes",
         "Beef & Buffalo"= "Livestock Primary - Beef and Buffalo Meat - 1806 - Production - 5510 - tonnes",
         "Pig"= "Livestock Primary - Meat, pig - 1035 - Production - 5510 - tonnes",
         "Wild Game"= "Livestock Primary - Meat, game - 1163 - Production - 5510 - tonnes",
         "Duck"= "Livestock Primary - Meat, duck - 1069 - Production - 5510 - tonnes",
         "Poltry"= "Livestock Primary - Meat, Poultry - 1808 - Production - 5510 - tonnes",
         "Horse"= "Livestock Primary - Meat, horse - 1097 - Production - 5510 - tonnes",
         "Camel"= "Livestock Primary - Meat, camel - 1127 - Production - 5510 - tonnes",
         "Goose & Guinea fowl"= "Livestock Primary - Meat, goose and guinea fowl - 1073 - Production - 5510 - tonnes") %>%
  filter(Entity== "World") %>% 
    group_by(Entity, Year)

pt_world_long <- pt_world %>% 
  pivot_longer(cols= "Sheep & Goat":"Goose & Guinea fowl",
               names_to= "Type",
               values_to = "Amount")

plt_type1<- ggplot(pt_world_long, aes(x= Year,
                                    y= Amount, 
                                    fill= Type))+ 
    geom_area(alpha=0.6 , size=.5, colour="white")+
    scale_fill_viridis(discrete = T) +
    theme_minimal()
plt_type1
```
.content-box[In first figure, we see that the **dominant livestock types are poultry**, cattle (which includes beef and buffalo meat), pig, and sheep & goat to a lesser extent at global level.
]

---
class: middle, center
```{r fig2, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Meat production by livestock type, 1961 to 2018"}
plt_type2<- ggplot(pt_world_long, aes(x= Year,
                                     y= Amount,
                                     group= Type,
                                     fill= Type))+
    geom_area() +
    scale_fill_viridis(discrete = TRUE)+
    theme_minimal() +
    facet_wrap(~ Type, scale="free_y")
plt_type2
```
.content-box[From second figure, we can see the production of all major meat types have been increasing. But **the share of global meat types have changed significantly**. 
  - In 1960s poultry meat accounted for small portion; by 2010s its share has tripled. 
  - Beef and buffalo meat as a share of total meat production has nearly halved. 
  - Pig meat’s share has remained more constant.
]

---
class: middle, center
```{r tidydata, echo = FALSE , message = FALSE, warning = FALSE}
pd_type <- MT %>%
  select(-Code) %>% 
  rename("Sheep & Goat"= "Livestock Primary - Sheep and Goat Meat - 1807 - Production - 5510 - tonnes",
         "Beef & Buffalo"= "Livestock Primary - Beef and Buffalo Meat - 1806 - Production - 5510 - tonnes",
         "Pig"= "Livestock Primary - Meat, pig - 1035 - Production - 5510 - tonnes",
         "Wild Game"= "Livestock Primary - Meat, game - 1163 - Production - 5510 - tonnes",
         "Duck"= "Livestock Primary - Meat, duck - 1069 - Production - 5510 - tonnes",
         "Poultry"= "Livestock Primary - Meat, Poultry - 1808 - Production - 5510 - tonnes",
         "Horse"= "Livestock Primary - Meat, horse - 1097 - Production - 5510 - tonnes",
         "Camel"= "Livestock Primary - Meat, camel - 1127 - Production - 5510 - tonnes",
         "Goose & Guinea fowl"= "Livestock Primary - Meat, goose and guinea fowl - 1073 - Production - 5510 - tonnes") %>%
    group_by(Entity, Year) %>%
    pivot_longer(cols= "Sheep & Goat":"Goose & Guinea fowl",
               names_to= "Type",
               values_to = "Amount")
```

```{r cattle, echo = FALSE , message = FALSE, warning = FALSE}
pd_cattle <- pd_type %>% 
    filter(Type == "Beef & Buffalo") %>% 
    group_by(Entity) %>% 
    summarise(Total= sum(Amount))%>% 
    arrange(-Total)


kable(head(pd_cattle, 20), caption = "Beef and buffalo (cattle) meat production, 1961-2018", booktabs = T)%>%
kable_material(c("striped", "hover"), position = "center")


```

]

---
class: middle, center
```{r cattle-fig, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Cattle production, 1961 to 2018"}
top_cattle<- pd_type %>% 
  filter(Entity %in% c("United States",
                       "China",
                       "Brazil")) %>% 
  filter(Type== "Beef & Buffalo") %>% 
  group_by(Entity)

ggplot(top_cattle, aes(x= Year, y= Amount, color= Entity))+
      geom_line()+
    scale_fill_viridis(discrete = TRUE) +
    theme_minimal()
```

.content-box[In first table, we see the global production of cattle (beef and buffalo) meat. From country's perspective, **The United States is the world’s largest beef and buffalo meat producer**. Other major producers are Brazil and China.
]

---
class: middle, center
```{r poultry, echo = FALSE , message = FALSE, warning = FALSE}
pd_poultry <- pd_type %>% 
    filter(Type == "Poultry") %>% 
    group_by(Entity) %>% 
    summarise(Total= sum(Amount))%>% 
    arrange(-Total)

kable(head(pd_cattle, 20), caption = "Poultry meat production, 1961-2018", booktabs = T)%>%
kable_material(c("striped", "hover"), position = "center")
```

---
class: middle, center
```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "poultry production, 1961 to 2018"}
top_poultry<- pd_type %>% 
  filter(Entity %in% c("United States",
                       "China",
                       "Brazil",
                       "Europe")) %>% 
  filter(Type== "Poultry") %>% 
  group_by(Entity)

ggplot(top_poultry, aes(x= Year, y= Amount, color= Entity))+
  geom_line()+
  scale_fill_viridis(discrete = TRUE) +
  theme_minimal()
```

.content-box[In second table, we can see the production of poultry, like cattle production, **the United States is still the world’s largest producer.** China and Brazil are also large poultry producers. Collectively, Europe is also a major poultry producer, just below the United States.
]

---
class: middle, center
```{r pig, echo = FALSE , message = FALSE, warning = FALSE}
pd_pigmeat <- pd_type %>% 
    filter(Type == "Pig") %>% 
    group_by(Entity) %>% 
    summarise(Total= sum(Amount))%>% 
    arrange(-Total)

kable(head(pd_pigmeat, 20), caption = "Pig meat production, 1961-2018", booktabs = T)%>%
kable_material(c("striped", "hover"), position = "center")
```

---
class: middle, center
```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "pig production, 1961 to 2018"}
top_pigmeat<- pd_type %>% 
  filter(Entity %in% c("United States",
                       "China",
                       "Germany")) %>% 
  filter(Type== "Pig") %>% 
  group_by(Entity)

ggplot(top_pigmeat, aes(x= Year, y= Amount, color= Entity))+
  geom_line()+
  scale_fill_viridis(discrete = TRUE) +
  theme_minimal()
```

.content-box[But for pigmeat production , **China dominates global output, producing just short of half of total pigmeat.** The other major producers include the United States, Germany.
]